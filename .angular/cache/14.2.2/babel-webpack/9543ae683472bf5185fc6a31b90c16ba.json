{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.symbol.to-primitive.js\";\nimport \"core-js/modules/es.date.to-primitive.js\";\nimport \"core-js/modules/es.number.constructor.js\";\n\nvar _global$FEATURES;\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\n\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n\n  return (hint === \"string\" ? String : Number)(input);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.values.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\n/* eslint-disable no-underscore-dangle */\n\nimport { addons } from '@storybook/addons';\nimport { once } from '@storybook/client-logger';\nimport { FORCE_REMOUNT, IGNORED_EXCEPTION, SET_CURRENT_STORY, STORY_RENDER_PHASE_CHANGED } from '@storybook/core-events';\nimport global from 'global';\nimport { CallStates } from './types';\nexport var EVENTS = {\n  CALL: 'instrumenter/call',\n  SYNC: 'instrumenter/sync',\n  START: 'instrumenter/start',\n  BACK: 'instrumenter/back',\n  GOTO: 'instrumenter/goto',\n  NEXT: 'instrumenter/next',\n  END: 'instrumenter/end'\n};\nvar debuggerDisabled = ((_global$FEATURES = global.FEATURES) === null || _global$FEATURES === void 0 ? void 0 : _global$FEATURES.interactionsDebugger) !== true;\nvar controlsDisabled = {\n  debugger: !debuggerDisabled,\n  start: false,\n  back: false,\n  goto: false,\n  next: false,\n  end: false\n};\nvar alreadyCompletedException = new Error(\"This function ran after the play function completed. Did you forget to `await` it?\");\n\nvar isObject = function isObject(o) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n};\n\nvar isModule = function isModule(o) {\n  return Object.prototype.toString.call(o) === '[object Module]';\n};\n\nvar isInstrumentable = function isInstrumentable(o) {\n  if (!isObject(o) && !isModule(o)) return false;\n  if (o.constructor === undefined) return true;\n  var proto = o.constructor.prototype;\n  if (!isObject(proto)) return false;\n  if (Object.prototype.hasOwnProperty.call(proto, 'isPrototypeOf') === false) return false;\n  return true;\n};\n\nvar construct = function construct(obj) {\n  try {\n    return new obj.constructor();\n  } catch (e) {\n    return {};\n  }\n};\n\nvar getInitialState = function getInitialState() {\n  return {\n    renderPhase: undefined,\n    isDebugging: false,\n    isPlaying: false,\n    isLocked: false,\n    cursor: 0,\n    calls: [],\n    shadowCalls: [],\n    callRefsByResult: new Map(),\n    chainedCallIds: new Set(),\n    parentId: undefined,\n    playUntil: undefined,\n    resolvers: {},\n    syncTimeout: undefined,\n    forwardedException: undefined\n  };\n};\n\nvar getRetainedState = function getRetainedState(state) {\n  var isDebugging = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var calls = (isDebugging ? state.shadowCalls : state.calls).filter(function (call) {\n    return call.retain;\n  });\n  if (!calls.length) return undefined;\n  var callRefsByResult = new Map(Array.from(state.callRefsByResult.entries()).filter(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        ref = _ref2[1];\n\n    return ref.retain;\n  }));\n  return {\n    cursor: calls.length,\n    calls: calls,\n    callRefsByResult: callRefsByResult\n  };\n};\n/**\n * This class is not supposed to be used directly. Use the `instrument` function below instead.\n */\n\n\nexport var Instrumenter = /*#__PURE__*/function () {\n  // State is tracked per story to deal with multiple stories on the same canvas (i.e. docs mode)\n  function Instrumenter() {\n    var _this = this;\n\n    _classCallCheck(this, Instrumenter);\n\n    this.channel = void 0;\n    this.initialized = false;\n    this.state = void 0;\n    this.channel = addons.getChannel(); // Restore state from the parent window in case the iframe was reloaded.\n\n    this.state = global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ || {}; // When called from `start`, isDebugging will be true\n\n    var resetState = function resetState(_ref3) {\n      var storyId = _ref3.storyId,\n          _ref3$isPlaying = _ref3.isPlaying,\n          isPlaying = _ref3$isPlaying === void 0 ? true : _ref3$isPlaying,\n          _ref3$isDebugging = _ref3.isDebugging,\n          isDebugging = _ref3$isDebugging === void 0 ? false : _ref3$isDebugging;\n\n      var state = _this.getState(storyId);\n\n      _this.setState(storyId, Object.assign({}, getInitialState(), getRetainedState(state, isDebugging), {\n        shadowCalls: isDebugging ? state.shadowCalls : [],\n        chainedCallIds: isDebugging ? state.chainedCallIds : new Set(),\n        playUntil: isDebugging ? state.playUntil : undefined,\n        isPlaying: isPlaying,\n        isDebugging: isDebugging\n      })); // Don't sync while debugging, as it'll cause flicker.\n\n\n      if (!isDebugging) _this.sync(storyId);\n    }; // A forceRemount might be triggered for debugging (on `start`), or elsewhere in Storybook.\n\n\n    this.channel.on(FORCE_REMOUNT, resetState); // Start with a clean slate before playing after a remount, and stop debugging when done.\n\n    this.channel.on(STORY_RENDER_PHASE_CHANGED, function (_ref4) {\n      var storyId = _ref4.storyId,\n          newPhase = _ref4.newPhase;\n\n      var _this$getState = _this.getState(storyId),\n          isDebugging = _this$getState.isDebugging,\n          forwardedException = _this$getState.forwardedException;\n\n      _this.setState(storyId, {\n        renderPhase: newPhase\n      });\n\n      if (newPhase === 'playing') {\n        resetState({\n          storyId: storyId,\n          isDebugging: isDebugging\n        });\n      }\n\n      if (newPhase === 'played') {\n        _this.setState(storyId, {\n          isLocked: false,\n          isPlaying: false,\n          isDebugging: false,\n          forwardedException: undefined\n        }); // Rethrow any unhandled forwarded exception so it doesn't go unnoticed.\n\n\n        if (forwardedException) throw forwardedException;\n      }\n    }); // Trash non-retained state and clear the log when switching stories, but not on initial boot.\n\n    this.channel.on(SET_CURRENT_STORY, function () {\n      if (_this.initialized) _this.cleanup();else _this.initialized = true;\n    });\n\n    var start = function start(_ref5) {\n      var storyId = _ref5.storyId,\n          playUntil = _ref5.playUntil;\n\n      if (!_this.getState(storyId).isDebugging) {\n        _this.setState(storyId, function (_ref6) {\n          var calls = _ref6.calls;\n          return {\n            calls: [],\n            shadowCalls: calls.map(function (call) {\n              return Object.assign({}, call, {\n                status: CallStates.WAITING\n              });\n            }),\n            isDebugging: true\n          };\n        });\n      }\n\n      var log = _this.getLog(storyId);\n\n      _this.setState(storyId, function (_ref7) {\n        var _shadowCalls$slice$fi;\n\n        var shadowCalls = _ref7.shadowCalls;\n        var firstRowIndex = shadowCalls.findIndex(function (call) {\n          return call.id === log[0].callId;\n        });\n        return {\n          playUntil: playUntil || ((_shadowCalls$slice$fi = shadowCalls.slice(0, firstRowIndex).filter(function (call) {\n            return call.interceptable;\n          }).slice(-1)[0]) === null || _shadowCalls$slice$fi === void 0 ? void 0 : _shadowCalls$slice$fi.id)\n        };\n      }); // Force remount may trigger a page reload if the play function can't be aborted.\n\n\n      _this.channel.emit(FORCE_REMOUNT, {\n        storyId: storyId,\n        isDebugging: true\n      });\n    };\n\n    var back = function back(_ref8) {\n      var _log;\n\n      var storyId = _ref8.storyId;\n\n      var _this$getState2 = _this.getState(storyId),\n          isDebugging = _this$getState2.isDebugging;\n\n      var log = _this.getLog(storyId);\n\n      var next = isDebugging ? log.findIndex(function (_ref9) {\n        var status = _ref9.status;\n        return status === CallStates.WAITING;\n      }) : log.length;\n      start({\n        storyId: storyId,\n        playUntil: (_log = log[next - 2]) === null || _log === void 0 ? void 0 : _log.callId\n      });\n    };\n\n    var goto = function goto(_ref10) {\n      var storyId = _ref10.storyId,\n          callId = _ref10.callId;\n\n      var _this$getState3 = _this.getState(storyId),\n          calls = _this$getState3.calls,\n          shadowCalls = _this$getState3.shadowCalls,\n          resolvers = _this$getState3.resolvers;\n\n      var call = calls.find(function (_ref11) {\n        var id = _ref11.id;\n        return id === callId;\n      });\n      var shadowCall = shadowCalls.find(function (_ref12) {\n        var id = _ref12.id;\n        return id === callId;\n      });\n\n      if (!call && shadowCall && Object.values(resolvers).length > 0) {\n        var _this$getLog$find;\n\n        var nextId = (_this$getLog$find = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find === void 0 ? void 0 : _this$getLog$find.callId;\n        if (shadowCall.id !== nextId) _this.setState(storyId, {\n          playUntil: shadowCall.id\n        });\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        start({\n          storyId: storyId,\n          playUntil: callId\n        });\n      }\n    };\n\n    var next = function next(_ref13) {\n      var storyId = _ref13.storyId;\n\n      var _this$getState4 = _this.getState(storyId),\n          resolvers = _this$getState4.resolvers;\n\n      if (Object.values(resolvers).length > 0) {\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        var _this$getLog$find2;\n\n        var nextId = (_this$getLog$find2 = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find2 === void 0 ? void 0 : _this$getLog$find2.callId;\n        if (nextId) start({\n          storyId: storyId,\n          playUntil: nextId\n        });else end({\n          storyId: storyId\n        });\n      }\n    };\n\n    var end = function end(_ref14) {\n      var storyId = _ref14.storyId;\n\n      _this.setState(storyId, {\n        playUntil: undefined,\n        isDebugging: false\n      });\n\n      Object.values(_this.getState(storyId).resolvers).forEach(function (resolve) {\n        return resolve();\n      });\n    };\n\n    this.channel.on(EVENTS.START, start);\n    this.channel.on(EVENTS.BACK, back);\n    this.channel.on(EVENTS.GOTO, goto);\n    this.channel.on(EVENTS.NEXT, next);\n    this.channel.on(EVENTS.END, end);\n  }\n\n  _createClass(Instrumenter, [{\n    key: \"getState\",\n    value: function getState(storyId) {\n      return this.state[storyId] || getInitialState();\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(storyId, update) {\n      var state = this.getState(storyId);\n      var patch = typeof update === 'function' ? update(state) : update;\n      this.state = Object.assign({}, this.state, _defineProperty({}, storyId, Object.assign({}, state, patch))); // Track state on the parent window so we can reload the iframe without losing state.\n\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"cleanup\",\n    value: function cleanup() {\n      // Reset stories with retained state to their initial state, and drop the rest.\n      this.state = Object.entries(this.state).reduce(function (acc, _ref15) {\n        var _ref16 = _slicedToArray(_ref15, 2),\n            storyId = _ref16[0],\n            state = _ref16[1];\n\n        var retainedState = getRetainedState(state);\n        if (!retainedState) return acc;\n        acc[storyId] = Object.assign(getInitialState(), retainedState);\n        return acc;\n      }, {});\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlsDisabled,\n        logItems: []\n      });\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"getLog\",\n    value: function getLog(storyId) {\n      var _this$getState5 = this.getState(storyId),\n          calls = _this$getState5.calls,\n          shadowCalls = _this$getState5.shadowCalls;\n\n      var merged = _toConsumableArray(shadowCalls);\n\n      calls.forEach(function (call, index) {\n        merged[index] = call;\n      });\n      var seen = new Set();\n      return merged.reduceRight(function (acc, call) {\n        call.args.forEach(function (arg) {\n          if (arg !== null && arg !== void 0 && arg.__callId__) {\n            seen.add(arg.__callId__);\n          }\n        });\n        call.path.forEach(function (node) {\n          if (node.__callId__) {\n            seen.add(node.__callId__);\n          }\n        });\n\n        if (call.interceptable && !seen.has(call.id)) {\n          acc.unshift({\n            callId: call.id,\n            status: call.status\n          });\n          seen.add(call.id);\n        }\n\n        return acc;\n      }, []);\n    } // Traverses the object structure to recursively patch all function properties.\n    // Returns the original object, or a new object with the same constructor,\n    // depending on whether it should mutate.\n\n  }, {\n    key: \"instrument\",\n    value: function instrument(obj, options) {\n      var _this2 = this;\n\n      if (!isInstrumentable(obj)) return obj;\n      var _options$mutate = options.mutate,\n          mutate = _options$mutate === void 0 ? false : _options$mutate,\n          _options$path = options.path,\n          path = _options$path === void 0 ? [] : _options$path;\n      return Object.keys(obj).reduce(function (acc, key) {\n        var value = obj[key]; // Nothing to patch, but might be instrumentable, so we recurse\n\n        if (typeof value !== 'function') {\n          acc[key] = _this2.instrument(value, Object.assign({}, options, {\n            path: path.concat(key)\n          }));\n          return acc;\n        } // Already patched, so we pass through unchanged\n\n\n        if (typeof value.__originalFn__ === 'function') {\n          acc[key] = value;\n          return acc;\n        } // Patch the function and mark it \"patched\" by adding a reference to the original function\n\n\n        acc[key] = function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _this2.track(key, value, args, options);\n        };\n\n        acc[key].__originalFn__ = value; // Reuse the original name as the patched function's name\n\n        Object.defineProperty(acc[key], 'name', {\n          value: key,\n          writable: false\n        }); // Deal with functions that also act like an object\n\n        if (Object.keys(value).length > 0) {\n          Object.assign(acc[key], _this2.instrument(Object.assign({}, value), Object.assign({}, options, {\n            path: path.concat(key)\n          })));\n        }\n\n        return acc;\n      }, mutate ? obj : construct(obj));\n    } // Monkey patch an object method to record calls.\n    // Returns a function that invokes the original function, records the invocation (\"call\") and\n    // returns the original result.\n\n  }, {\n    key: \"track\",\n    value: function track(method, fn, args, options) {\n      var _args$, _global$window$__STOR, _global$window$__STOR2, _global$window$__STOR3;\n\n      var storyId = (args === null || args === void 0 ? void 0 : (_args$ = args[0]) === null || _args$ === void 0 ? void 0 : _args$.__storyId__) || ((_global$window$__STOR = global.window.__STORYBOOK_PREVIEW__) === null || _global$window$__STOR === void 0 ? void 0 : (_global$window$__STOR2 = _global$window$__STOR.urlStore) === null || _global$window$__STOR2 === void 0 ? void 0 : (_global$window$__STOR3 = _global$window$__STOR2.selection) === null || _global$window$__STOR3 === void 0 ? void 0 : _global$window$__STOR3.storyId);\n\n      var _this$getState6 = this.getState(storyId),\n          cursor = _this$getState6.cursor,\n          parentId = _this$getState6.parentId;\n\n      this.setState(storyId, {\n        cursor: cursor + 1\n      });\n      var id = \"\".concat(parentId || storyId, \" [\").concat(cursor, \"] \").concat(method);\n      var _options$path2 = options.path,\n          path = _options$path2 === void 0 ? [] : _options$path2,\n          _options$intercept = options.intercept,\n          intercept = _options$intercept === void 0 ? false : _options$intercept,\n          _options$retain = options.retain,\n          retain = _options$retain === void 0 ? false : _options$retain;\n      var interceptable = typeof intercept === 'function' ? intercept(method, path) : intercept;\n      var call = {\n        id: id,\n        parentId: parentId,\n        storyId: storyId,\n        cursor: cursor,\n        path: path,\n        method: method,\n        args: args,\n        interceptable: interceptable,\n        retain: retain\n      };\n      var result = (interceptable ? this.intercept : this.invoke).call(this, fn, call, options);\n      return this.instrument(result, Object.assign({}, options, {\n        mutate: true,\n        path: [{\n          __callId__: call.id\n        }]\n      }));\n    }\n  }, {\n    key: \"intercept\",\n    value: function intercept(fn, call, options) {\n      var _this3 = this;\n\n      var _this$getState7 = this.getState(call.storyId),\n          chainedCallIds = _this$getState7.chainedCallIds,\n          isDebugging = _this$getState7.isDebugging,\n          playUntil = _this$getState7.playUntil; // For a \"jump to step\" action, continue playing until we hit a call by that ID.\n      // For chained calls, we can only return a Promise for the last call in the chain.\n\n\n      var isChainedUpon = chainedCallIds.has(call.id);\n\n      if (!isDebugging || isChainedUpon || playUntil) {\n        if (playUntil === call.id) {\n          this.setState(call.storyId, {\n            playUntil: undefined\n          });\n        }\n\n        return this.invoke(fn, call, options);\n      } // Instead of invoking the function, defer the function call until we continue playing.\n\n\n      return new Promise(function (resolve) {\n        _this3.setState(call.storyId, function (_ref17) {\n          var resolvers = _ref17.resolvers;\n          return {\n            isLocked: false,\n            resolvers: Object.assign({}, resolvers, _defineProperty({}, call.id, resolve))\n          };\n        });\n      }).then(function () {\n        _this3.setState(call.storyId, function (state) {\n          var _state$resolvers = state.resolvers,\n              _call$id = call.id,\n              _ = _state$resolvers[_call$id],\n              resolvers = _objectWithoutProperties(_state$resolvers, [_call$id].map(_toPropertyKey));\n\n          return {\n            isLocked: true,\n            resolvers: resolvers\n          };\n        });\n\n        return _this3.invoke(fn, call, options);\n      });\n    }\n  }, {\n    key: \"invoke\",\n    value: function invoke(fn, call, options) {\n      var _this4 = this; // TODO this doesnt work because the abortSignal we have here is the newly created one\n      // const { abortSignal } = global.window.__STORYBOOK_PREVIEW__ || {};\n      // if (abortSignal && abortSignal.aborted) throw IGNORED_EXCEPTION;\n\n\n      var _this$getState8 = this.getState(call.storyId),\n          callRefsByResult = _this$getState8.callRefsByResult,\n          forwardedException = _this$getState8.forwardedException,\n          renderPhase = _this$getState8.renderPhase;\n\n      var info = Object.assign({}, call, {\n        // Map args that originate from a tracked function call to a call reference to enable nesting.\n        // These values are often not fully serializable anyway (e.g. HTML elements).\n        args: call.args.map(function (arg) {\n          if (callRefsByResult.has(arg)) {\n            return callRefsByResult.get(arg);\n          }\n\n          if (arg instanceof global.window.HTMLElement) {\n            var prefix = arg.prefix,\n                localName = arg.localName,\n                id = arg.id,\n                classList = arg.classList,\n                innerText = arg.innerText;\n            var classNames = Array.from(classList);\n            return {\n              __element__: {\n                prefix: prefix,\n                localName: localName,\n                id: id,\n                classNames: classNames,\n                innerText: innerText\n              }\n            };\n          }\n\n          return arg;\n        })\n      }); // Mark any ancestor calls as \"chained upon\" so we won't attempt to defer it later.\n\n      call.path.forEach(function (ref) {\n        if (ref !== null && ref !== void 0 && ref.__callId__) {\n          _this4.setState(call.storyId, function (_ref18) {\n            var chainedCallIds = _ref18.chainedCallIds;\n            return {\n              chainedCallIds: new Set(Array.from(chainedCallIds).concat(ref.__callId__))\n            };\n          });\n        }\n      });\n\n      var handleException = function handleException(e) {\n        if (e instanceof Error) {\n          var name = e.name,\n              message = e.message,\n              stack = e.stack;\n          var exception = {\n            name: name,\n            message: message,\n            stack: stack\n          };\n\n          _this4.update(Object.assign({}, info, {\n            status: CallStates.ERROR,\n            exception: exception\n          })); // Always track errors to their originating call.\n\n\n          _this4.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[e, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          }); // We need to throw to break out of the play function, but we don't want to trigger a redbox\n          // so we throw an ignoredException, which is caught and silently ignored by Storybook.\n\n\n          if (call.interceptable && e !== alreadyCompletedException) {\n            throw IGNORED_EXCEPTION;\n          } // Non-interceptable calls need their exceptions forwarded to the next interceptable call.\n          // In case no interceptable call picks it up, it'll get rethrown in the \"completed\" phase.\n\n\n          _this4.setState(call.storyId, {\n            forwardedException: e\n          });\n\n          return e;\n        }\n\n        throw e;\n      };\n\n      try {\n        // An earlier, non-interceptable call might have forwarded an exception.\n        if (forwardedException) {\n          this.setState(call.storyId, {\n            forwardedException: undefined\n          });\n          throw forwardedException;\n        }\n\n        if (renderPhase === 'played' && !call.retain) {\n          throw alreadyCompletedException;\n        }\n\n        var finalArgs = options.getArgs ? options.getArgs(call, this.getState(call.storyId)) : call.args;\n        var result = fn.apply(void 0, _toConsumableArray(finalArgs.map(function (arg) {\n          if (typeof arg !== 'function' || Object.keys(arg).length) return arg;\n          return function () {\n            var _this4$getState = _this4.getState(call.storyId),\n                cursor = _this4$getState.cursor,\n                parentId = _this4$getState.parentId;\n\n            _this4.setState(call.storyId, {\n              cursor: 0,\n              parentId: call.id\n            });\n\n            var restore = function restore() {\n              return _this4.setState(call.storyId, {\n                cursor: cursor,\n                parentId: parentId\n              });\n            };\n\n            var res = arg.apply(void 0, arguments);\n            if (res instanceof Promise) res.then(restore, restore);else restore();\n            return res;\n          };\n        }))); // Track the result so we can trace later uses of it back to the originating call.\n        // Primitive results (undefined, null, boolean, string, number, BigInt) are ignored.\n\n        if (result && ['object', 'function', 'symbol'].includes(_typeof(result))) {\n          this.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[result, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          });\n        }\n\n        this.update(Object.assign({}, info, {\n          status: result instanceof Promise ? CallStates.ACTIVE : CallStates.DONE\n        }));\n\n        if (result instanceof Promise) {\n          return result.then(function (value) {\n            _this4.update(Object.assign({}, info, {\n              status: CallStates.DONE\n            }));\n\n            return value;\n          }, handleException);\n        }\n\n        return result;\n      } catch (e) {\n        return handleException(e);\n      }\n    } // Sends the call info and log to the manager.\n    // Uses a 0ms debounce because this might get called many times in one tick.\n\n  }, {\n    key: \"update\",\n    value: function update(call) {\n      var _this5 = this;\n\n      clearTimeout(this.getState(call.storyId).syncTimeout);\n      this.channel.emit(EVENTS.CALL, call);\n      this.setState(call.storyId, function (_ref19) {\n        var calls = _ref19.calls; // Omit earlier calls for the same ID, which may have been superceded by a later invocation.\n        // This typically happens when calls are part of a callback which runs multiple times.\n\n        var callsById = calls.concat(call).reduce(function (a, c) {\n          return Object.assign(a, _defineProperty({}, c.id, c));\n        }, {});\n        return {\n          // Calls are sorted to ensure parent calls always come before calls in their callback.\n          calls: Object.values(callsById).sort(function (a, b) {\n            return a.id.localeCompare(b.id, undefined, {\n              numeric: true\n            });\n          }),\n          syncTimeout: setTimeout(function () {\n            return _this5.sync(call.storyId);\n          }, 0)\n        };\n      });\n    }\n  }, {\n    key: \"sync\",\n    value: function sync(storyId) {\n      var _this$getState9 = this.getState(storyId),\n          isLocked = _this$getState9.isLocked,\n          isPlaying = _this$getState9.isPlaying;\n\n      var logItems = this.getLog(storyId);\n      var hasActive = logItems.some(function (item) {\n        return item.status === CallStates.ACTIVE;\n      });\n\n      if (debuggerDisabled || isLocked || hasActive || logItems.length === 0) {\n        this.channel.emit(EVENTS.SYNC, {\n          controlStates: controlsDisabled,\n          logItems: logItems\n        });\n        return;\n      }\n\n      var hasPrevious = logItems.some(function (item) {\n        return [CallStates.DONE, CallStates.ERROR].includes(item.status);\n      });\n      var controlStates = {\n        debugger: true,\n        start: hasPrevious,\n        back: hasPrevious,\n        goto: true,\n        next: isPlaying,\n        end: isPlaying\n      };\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlStates,\n        logItems: logItems\n      });\n    }\n  }]);\n\n  return Instrumenter;\n}();\n/**\n * Instruments an object or module by traversing its properties, patching any functions (methods)\n * to enable debugging. Patched functions will emit a `call` event when invoked.\n * When intercept = true, patched functions will return a Promise when the debugger stops before\n * this function. As such, \"interceptable\" functions will have to be `await`-ed.\n */\n\nexport function instrument(obj) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  try {\n    var _global$window$locati, _global$window$locati2, _global$window$locati3, _global$window$locati4;\n\n    var forceInstrument = false;\n    var skipInstrument = false;\n\n    if ((_global$window$locati = global.window.location) !== null && _global$window$locati !== void 0 && (_global$window$locati2 = _global$window$locati.search) !== null && _global$window$locati2 !== void 0 && _global$window$locati2.includes('instrument=true')) {\n      forceInstrument = true;\n    } else if ((_global$window$locati3 = global.window.location) !== null && _global$window$locati3 !== void 0 && (_global$window$locati4 = _global$window$locati3.search) !== null && _global$window$locati4 !== void 0 && _global$window$locati4.includes('instrument=false')) {\n      skipInstrument = true;\n    } // Don't do any instrumentation if not loaded in an iframe unless it's forced - instrumentation can also be skipped.\n\n\n    if (global.window.parent === global.window && !forceInstrument || skipInstrument) {\n      return obj;\n    } // Only create an instance if we don't have one (singleton) yet.\n\n\n    if (!global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__) {\n      global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__ = new Instrumenter();\n    }\n\n    var instrumenter = global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__;\n    return instrumenter.instrument(obj, options);\n  } catch (e) {\n    // Access to the parent window might fail due to CORS restrictions.\n    once.warn(e);\n    return obj;\n  }\n}","map":{"version":3,"names":["_global$FEATURES","_typeof","obj","Symbol","iterator","constructor","prototype","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","Object","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","call","sourceKeys","keys","_toPropertyKey","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","TypeError","Number","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","iter","Array","from","isArray","_arrayLikeToArray","_defineProperty","value","defineProperty","enumerable","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","toString","slice","name","test","len","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","err","addons","once","FORCE_REMOUNT","IGNORED_EXCEPTION","SET_CURRENT_STORY","STORY_RENDER_PHASE_CHANGED","global","CallStates","EVENTS","CALL","SYNC","START","BACK","GOTO","NEXT","END","debuggerDisabled","FEATURES","interactionsDebugger","controlsDisabled","debugger","start","back","goto","end","alreadyCompletedException","Error","isObject","isModule","isInstrumentable","proto","hasOwnProperty","construct","e","getInitialState","renderPhase","isDebugging","isPlaying","isLocked","cursor","calls","shadowCalls","callRefsByResult","Map","chainedCallIds","Set","parentId","playUntil","resolvers","syncTimeout","forwardedException","getRetainedState","state","arguments","filter","retain","entries","_ref","_ref2","ref","Instrumenter","_this","channel","initialized","getChannel","window","parent","__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__","resetState","_ref3","storyId","_ref3$isPlaying","_ref3$isDebugging","getState","setState","assign","sync","on","_ref4","newPhase","_this$getState","cleanup","_ref5","_ref6","map","status","WAITING","log","getLog","_ref7","_shadowCalls$slice$fi","firstRowIndex","findIndex","id","callId","interceptable","emit","_ref8","_log","_this$getState2","_ref9","_ref10","_this$getState3","find","_ref11","shadowCall","_ref12","values","_this$getLog$find","nextId","c","forEach","resolve","_ref13","_this$getState4","_this$getLog$find2","_ref14","update","patch","reduce","acc","_ref15","_ref16","retainedState","controlStates","logItems","_this$getState5","merged","index","seen","reduceRight","args","__callId__","add","path","node","has","unshift","instrument","options","_this2","_options$mutate","mutate","_options$path","concat","__originalFn__","_len","_key","track","method","fn","_args$","_global$window$__STOR","_global$window$__STOR2","_global$window$__STOR3","__storyId__","__STORYBOOK_PREVIEW__","urlStore","selection","_this$getState6","_options$path2","_options$intercept","intercept","_options$retain","result","invoke","_this3","_this$getState7","isChainedUpon","Promise","_ref17","then","_state$resolvers","_call$id","_","_this4","_this$getState8","info","get","HTMLElement","prefix","localName","classList","innerText","classNames","__element__","_ref18","handleException","message","stack","exception","ERROR","finalArgs","getArgs","apply","_this4$getState","restore","includes","ACTIVE","DONE","_this5","clearTimeout","_ref19","callsById","a","sort","b","localeCompare","numeric","setTimeout","_this$getState9","hasActive","some","item","hasPrevious","_global$window$locati","_global$window$locati2","_global$window$locati3","_global$window$locati4","forceInstrument","skipInstrument","location","search","__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__","instrumenter","warn"],"sources":["/Users/victorsan/Documents/htdocs/wabi-demo-monorepo/node_modules/@storybook/instrumenter/dist/esm/instrumenter.js"],"sourcesContent":["import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.symbol.to-primitive.js\";\nimport \"core-js/modules/es.date.to-primitive.js\";\nimport \"core-js/modules/es.number.constructor.js\";\n\nvar _global$FEATURES;\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.values.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\n\n/* eslint-disable no-underscore-dangle */\nimport { addons } from '@storybook/addons';\nimport { once } from '@storybook/client-logger';\nimport { FORCE_REMOUNT, IGNORED_EXCEPTION, SET_CURRENT_STORY, STORY_RENDER_PHASE_CHANGED } from '@storybook/core-events';\nimport global from 'global';\nimport { CallStates } from './types';\nexport var EVENTS = {\n  CALL: 'instrumenter/call',\n  SYNC: 'instrumenter/sync',\n  START: 'instrumenter/start',\n  BACK: 'instrumenter/back',\n  GOTO: 'instrumenter/goto',\n  NEXT: 'instrumenter/next',\n  END: 'instrumenter/end'\n};\nvar debuggerDisabled = ((_global$FEATURES = global.FEATURES) === null || _global$FEATURES === void 0 ? void 0 : _global$FEATURES.interactionsDebugger) !== true;\nvar controlsDisabled = {\n  debugger: !debuggerDisabled,\n  start: false,\n  back: false,\n  goto: false,\n  next: false,\n  end: false\n};\nvar alreadyCompletedException = new Error(\"This function ran after the play function completed. Did you forget to `await` it?\");\n\nvar isObject = function isObject(o) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n};\n\nvar isModule = function isModule(o) {\n  return Object.prototype.toString.call(o) === '[object Module]';\n};\n\nvar isInstrumentable = function isInstrumentable(o) {\n  if (!isObject(o) && !isModule(o)) return false;\n  if (o.constructor === undefined) return true;\n  var proto = o.constructor.prototype;\n  if (!isObject(proto)) return false;\n  if (Object.prototype.hasOwnProperty.call(proto, 'isPrototypeOf') === false) return false;\n  return true;\n};\n\nvar construct = function construct(obj) {\n  try {\n    return new obj.constructor();\n  } catch (e) {\n    return {};\n  }\n};\n\nvar getInitialState = function getInitialState() {\n  return {\n    renderPhase: undefined,\n    isDebugging: false,\n    isPlaying: false,\n    isLocked: false,\n    cursor: 0,\n    calls: [],\n    shadowCalls: [],\n    callRefsByResult: new Map(),\n    chainedCallIds: new Set(),\n    parentId: undefined,\n    playUntil: undefined,\n    resolvers: {},\n    syncTimeout: undefined,\n    forwardedException: undefined\n  };\n};\n\nvar getRetainedState = function getRetainedState(state) {\n  var isDebugging = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var calls = (isDebugging ? state.shadowCalls : state.calls).filter(function (call) {\n    return call.retain;\n  });\n  if (!calls.length) return undefined;\n  var callRefsByResult = new Map(Array.from(state.callRefsByResult.entries()).filter(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        ref = _ref2[1];\n\n    return ref.retain;\n  }));\n  return {\n    cursor: calls.length,\n    calls: calls,\n    callRefsByResult: callRefsByResult\n  };\n};\n/**\n * This class is not supposed to be used directly. Use the `instrument` function below instead.\n */\n\n\nexport var Instrumenter = /*#__PURE__*/function () {\n  // State is tracked per story to deal with multiple stories on the same canvas (i.e. docs mode)\n  function Instrumenter() {\n    var _this = this;\n\n    _classCallCheck(this, Instrumenter);\n\n    this.channel = void 0;\n    this.initialized = false;\n    this.state = void 0;\n    this.channel = addons.getChannel(); // Restore state from the parent window in case the iframe was reloaded.\n\n    this.state = global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ || {}; // When called from `start`, isDebugging will be true\n\n    var resetState = function resetState(_ref3) {\n      var storyId = _ref3.storyId,\n          _ref3$isPlaying = _ref3.isPlaying,\n          isPlaying = _ref3$isPlaying === void 0 ? true : _ref3$isPlaying,\n          _ref3$isDebugging = _ref3.isDebugging,\n          isDebugging = _ref3$isDebugging === void 0 ? false : _ref3$isDebugging;\n\n      var state = _this.getState(storyId);\n\n      _this.setState(storyId, Object.assign({}, getInitialState(), getRetainedState(state, isDebugging), {\n        shadowCalls: isDebugging ? state.shadowCalls : [],\n        chainedCallIds: isDebugging ? state.chainedCallIds : new Set(),\n        playUntil: isDebugging ? state.playUntil : undefined,\n        isPlaying: isPlaying,\n        isDebugging: isDebugging\n      })); // Don't sync while debugging, as it'll cause flicker.\n\n\n      if (!isDebugging) _this.sync(storyId);\n    }; // A forceRemount might be triggered for debugging (on `start`), or elsewhere in Storybook.\n\n\n    this.channel.on(FORCE_REMOUNT, resetState); // Start with a clean slate before playing after a remount, and stop debugging when done.\n\n    this.channel.on(STORY_RENDER_PHASE_CHANGED, function (_ref4) {\n      var storyId = _ref4.storyId,\n          newPhase = _ref4.newPhase;\n\n      var _this$getState = _this.getState(storyId),\n          isDebugging = _this$getState.isDebugging,\n          forwardedException = _this$getState.forwardedException;\n\n      _this.setState(storyId, {\n        renderPhase: newPhase\n      });\n\n      if (newPhase === 'playing') {\n        resetState({\n          storyId: storyId,\n          isDebugging: isDebugging\n        });\n      }\n\n      if (newPhase === 'played') {\n        _this.setState(storyId, {\n          isLocked: false,\n          isPlaying: false,\n          isDebugging: false,\n          forwardedException: undefined\n        }); // Rethrow any unhandled forwarded exception so it doesn't go unnoticed.\n\n\n        if (forwardedException) throw forwardedException;\n      }\n    }); // Trash non-retained state and clear the log when switching stories, but not on initial boot.\n\n    this.channel.on(SET_CURRENT_STORY, function () {\n      if (_this.initialized) _this.cleanup();else _this.initialized = true;\n    });\n\n    var start = function start(_ref5) {\n      var storyId = _ref5.storyId,\n          playUntil = _ref5.playUntil;\n\n      if (!_this.getState(storyId).isDebugging) {\n        _this.setState(storyId, function (_ref6) {\n          var calls = _ref6.calls;\n          return {\n            calls: [],\n            shadowCalls: calls.map(function (call) {\n              return Object.assign({}, call, {\n                status: CallStates.WAITING\n              });\n            }),\n            isDebugging: true\n          };\n        });\n      }\n\n      var log = _this.getLog(storyId);\n\n      _this.setState(storyId, function (_ref7) {\n        var _shadowCalls$slice$fi;\n\n        var shadowCalls = _ref7.shadowCalls;\n        var firstRowIndex = shadowCalls.findIndex(function (call) {\n          return call.id === log[0].callId;\n        });\n        return {\n          playUntil: playUntil || ((_shadowCalls$slice$fi = shadowCalls.slice(0, firstRowIndex).filter(function (call) {\n            return call.interceptable;\n          }).slice(-1)[0]) === null || _shadowCalls$slice$fi === void 0 ? void 0 : _shadowCalls$slice$fi.id)\n        };\n      }); // Force remount may trigger a page reload if the play function can't be aborted.\n\n\n      _this.channel.emit(FORCE_REMOUNT, {\n        storyId: storyId,\n        isDebugging: true\n      });\n    };\n\n    var back = function back(_ref8) {\n      var _log;\n\n      var storyId = _ref8.storyId;\n\n      var _this$getState2 = _this.getState(storyId),\n          isDebugging = _this$getState2.isDebugging;\n\n      var log = _this.getLog(storyId);\n\n      var next = isDebugging ? log.findIndex(function (_ref9) {\n        var status = _ref9.status;\n        return status === CallStates.WAITING;\n      }) : log.length;\n      start({\n        storyId: storyId,\n        playUntil: (_log = log[next - 2]) === null || _log === void 0 ? void 0 : _log.callId\n      });\n    };\n\n    var goto = function goto(_ref10) {\n      var storyId = _ref10.storyId,\n          callId = _ref10.callId;\n\n      var _this$getState3 = _this.getState(storyId),\n          calls = _this$getState3.calls,\n          shadowCalls = _this$getState3.shadowCalls,\n          resolvers = _this$getState3.resolvers;\n\n      var call = calls.find(function (_ref11) {\n        var id = _ref11.id;\n        return id === callId;\n      });\n      var shadowCall = shadowCalls.find(function (_ref12) {\n        var id = _ref12.id;\n        return id === callId;\n      });\n\n      if (!call && shadowCall && Object.values(resolvers).length > 0) {\n        var _this$getLog$find;\n\n        var nextId = (_this$getLog$find = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find === void 0 ? void 0 : _this$getLog$find.callId;\n        if (shadowCall.id !== nextId) _this.setState(storyId, {\n          playUntil: shadowCall.id\n        });\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        start({\n          storyId: storyId,\n          playUntil: callId\n        });\n      }\n    };\n\n    var next = function next(_ref13) {\n      var storyId = _ref13.storyId;\n\n      var _this$getState4 = _this.getState(storyId),\n          resolvers = _this$getState4.resolvers;\n\n      if (Object.values(resolvers).length > 0) {\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        var _this$getLog$find2;\n\n        var nextId = (_this$getLog$find2 = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find2 === void 0 ? void 0 : _this$getLog$find2.callId;\n        if (nextId) start({\n          storyId: storyId,\n          playUntil: nextId\n        });else end({\n          storyId: storyId\n        });\n      }\n    };\n\n    var end = function end(_ref14) {\n      var storyId = _ref14.storyId;\n\n      _this.setState(storyId, {\n        playUntil: undefined,\n        isDebugging: false\n      });\n\n      Object.values(_this.getState(storyId).resolvers).forEach(function (resolve) {\n        return resolve();\n      });\n    };\n\n    this.channel.on(EVENTS.START, start);\n    this.channel.on(EVENTS.BACK, back);\n    this.channel.on(EVENTS.GOTO, goto);\n    this.channel.on(EVENTS.NEXT, next);\n    this.channel.on(EVENTS.END, end);\n  }\n\n  _createClass(Instrumenter, [{\n    key: \"getState\",\n    value: function getState(storyId) {\n      return this.state[storyId] || getInitialState();\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(storyId, update) {\n      var state = this.getState(storyId);\n      var patch = typeof update === 'function' ? update(state) : update;\n      this.state = Object.assign({}, this.state, _defineProperty({}, storyId, Object.assign({}, state, patch))); // Track state on the parent window so we can reload the iframe without losing state.\n\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"cleanup\",\n    value: function cleanup() {\n      // Reset stories with retained state to their initial state, and drop the rest.\n      this.state = Object.entries(this.state).reduce(function (acc, _ref15) {\n        var _ref16 = _slicedToArray(_ref15, 2),\n            storyId = _ref16[0],\n            state = _ref16[1];\n\n        var retainedState = getRetainedState(state);\n        if (!retainedState) return acc;\n        acc[storyId] = Object.assign(getInitialState(), retainedState);\n        return acc;\n      }, {});\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlsDisabled,\n        logItems: []\n      });\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"getLog\",\n    value: function getLog(storyId) {\n      var _this$getState5 = this.getState(storyId),\n          calls = _this$getState5.calls,\n          shadowCalls = _this$getState5.shadowCalls;\n\n      var merged = _toConsumableArray(shadowCalls);\n\n      calls.forEach(function (call, index) {\n        merged[index] = call;\n      });\n      var seen = new Set();\n      return merged.reduceRight(function (acc, call) {\n        call.args.forEach(function (arg) {\n          if (arg !== null && arg !== void 0 && arg.__callId__) {\n            seen.add(arg.__callId__);\n          }\n        });\n        call.path.forEach(function (node) {\n          if (node.__callId__) {\n            seen.add(node.__callId__);\n          }\n        });\n\n        if (call.interceptable && !seen.has(call.id)) {\n          acc.unshift({\n            callId: call.id,\n            status: call.status\n          });\n          seen.add(call.id);\n        }\n\n        return acc;\n      }, []);\n    } // Traverses the object structure to recursively patch all function properties.\n    // Returns the original object, or a new object with the same constructor,\n    // depending on whether it should mutate.\n\n  }, {\n    key: \"instrument\",\n    value: function instrument(obj, options) {\n      var _this2 = this;\n\n      if (!isInstrumentable(obj)) return obj;\n      var _options$mutate = options.mutate,\n          mutate = _options$mutate === void 0 ? false : _options$mutate,\n          _options$path = options.path,\n          path = _options$path === void 0 ? [] : _options$path;\n      return Object.keys(obj).reduce(function (acc, key) {\n        var value = obj[key]; // Nothing to patch, but might be instrumentable, so we recurse\n\n        if (typeof value !== 'function') {\n          acc[key] = _this2.instrument(value, Object.assign({}, options, {\n            path: path.concat(key)\n          }));\n          return acc;\n        } // Already patched, so we pass through unchanged\n\n\n        if (typeof value.__originalFn__ === 'function') {\n          acc[key] = value;\n          return acc;\n        } // Patch the function and mark it \"patched\" by adding a reference to the original function\n\n\n        acc[key] = function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _this2.track(key, value, args, options);\n        };\n\n        acc[key].__originalFn__ = value; // Reuse the original name as the patched function's name\n\n        Object.defineProperty(acc[key], 'name', {\n          value: key,\n          writable: false\n        }); // Deal with functions that also act like an object\n\n        if (Object.keys(value).length > 0) {\n          Object.assign(acc[key], _this2.instrument(Object.assign({}, value), Object.assign({}, options, {\n            path: path.concat(key)\n          })));\n        }\n\n        return acc;\n      }, mutate ? obj : construct(obj));\n    } // Monkey patch an object method to record calls.\n    // Returns a function that invokes the original function, records the invocation (\"call\") and\n    // returns the original result.\n\n  }, {\n    key: \"track\",\n    value: function track(method, fn, args, options) {\n      var _args$, _global$window$__STOR, _global$window$__STOR2, _global$window$__STOR3;\n\n      var storyId = (args === null || args === void 0 ? void 0 : (_args$ = args[0]) === null || _args$ === void 0 ? void 0 : _args$.__storyId__) || ((_global$window$__STOR = global.window.__STORYBOOK_PREVIEW__) === null || _global$window$__STOR === void 0 ? void 0 : (_global$window$__STOR2 = _global$window$__STOR.urlStore) === null || _global$window$__STOR2 === void 0 ? void 0 : (_global$window$__STOR3 = _global$window$__STOR2.selection) === null || _global$window$__STOR3 === void 0 ? void 0 : _global$window$__STOR3.storyId);\n\n      var _this$getState6 = this.getState(storyId),\n          cursor = _this$getState6.cursor,\n          parentId = _this$getState6.parentId;\n\n      this.setState(storyId, {\n        cursor: cursor + 1\n      });\n      var id = \"\".concat(parentId || storyId, \" [\").concat(cursor, \"] \").concat(method);\n      var _options$path2 = options.path,\n          path = _options$path2 === void 0 ? [] : _options$path2,\n          _options$intercept = options.intercept,\n          intercept = _options$intercept === void 0 ? false : _options$intercept,\n          _options$retain = options.retain,\n          retain = _options$retain === void 0 ? false : _options$retain;\n      var interceptable = typeof intercept === 'function' ? intercept(method, path) : intercept;\n      var call = {\n        id: id,\n        parentId: parentId,\n        storyId: storyId,\n        cursor: cursor,\n        path: path,\n        method: method,\n        args: args,\n        interceptable: interceptable,\n        retain: retain\n      };\n      var result = (interceptable ? this.intercept : this.invoke).call(this, fn, call, options);\n      return this.instrument(result, Object.assign({}, options, {\n        mutate: true,\n        path: [{\n          __callId__: call.id\n        }]\n      }));\n    }\n  }, {\n    key: \"intercept\",\n    value: function intercept(fn, call, options) {\n      var _this3 = this;\n\n      var _this$getState7 = this.getState(call.storyId),\n          chainedCallIds = _this$getState7.chainedCallIds,\n          isDebugging = _this$getState7.isDebugging,\n          playUntil = _this$getState7.playUntil; // For a \"jump to step\" action, continue playing until we hit a call by that ID.\n      // For chained calls, we can only return a Promise for the last call in the chain.\n\n\n      var isChainedUpon = chainedCallIds.has(call.id);\n\n      if (!isDebugging || isChainedUpon || playUntil) {\n        if (playUntil === call.id) {\n          this.setState(call.storyId, {\n            playUntil: undefined\n          });\n        }\n\n        return this.invoke(fn, call, options);\n      } // Instead of invoking the function, defer the function call until we continue playing.\n\n\n      return new Promise(function (resolve) {\n        _this3.setState(call.storyId, function (_ref17) {\n          var resolvers = _ref17.resolvers;\n          return {\n            isLocked: false,\n            resolvers: Object.assign({}, resolvers, _defineProperty({}, call.id, resolve))\n          };\n        });\n      }).then(function () {\n        _this3.setState(call.storyId, function (state) {\n          var _state$resolvers = state.resolvers,\n              _call$id = call.id,\n              _ = _state$resolvers[_call$id],\n              resolvers = _objectWithoutProperties(_state$resolvers, [_call$id].map(_toPropertyKey));\n\n          return {\n            isLocked: true,\n            resolvers: resolvers\n          };\n        });\n\n        return _this3.invoke(fn, call, options);\n      });\n    }\n  }, {\n    key: \"invoke\",\n    value: function invoke(fn, call, options) {\n      var _this4 = this;\n\n      // TODO this doesnt work because the abortSignal we have here is the newly created one\n      // const { abortSignal } = global.window.__STORYBOOK_PREVIEW__ || {};\n      // if (abortSignal && abortSignal.aborted) throw IGNORED_EXCEPTION;\n      var _this$getState8 = this.getState(call.storyId),\n          callRefsByResult = _this$getState8.callRefsByResult,\n          forwardedException = _this$getState8.forwardedException,\n          renderPhase = _this$getState8.renderPhase;\n\n      var info = Object.assign({}, call, {\n        // Map args that originate from a tracked function call to a call reference to enable nesting.\n        // These values are often not fully serializable anyway (e.g. HTML elements).\n        args: call.args.map(function (arg) {\n          if (callRefsByResult.has(arg)) {\n            return callRefsByResult.get(arg);\n          }\n\n          if (arg instanceof global.window.HTMLElement) {\n            var prefix = arg.prefix,\n                localName = arg.localName,\n                id = arg.id,\n                classList = arg.classList,\n                innerText = arg.innerText;\n            var classNames = Array.from(classList);\n            return {\n              __element__: {\n                prefix: prefix,\n                localName: localName,\n                id: id,\n                classNames: classNames,\n                innerText: innerText\n              }\n            };\n          }\n\n          return arg;\n        })\n      }); // Mark any ancestor calls as \"chained upon\" so we won't attempt to defer it later.\n\n      call.path.forEach(function (ref) {\n        if (ref !== null && ref !== void 0 && ref.__callId__) {\n          _this4.setState(call.storyId, function (_ref18) {\n            var chainedCallIds = _ref18.chainedCallIds;\n            return {\n              chainedCallIds: new Set(Array.from(chainedCallIds).concat(ref.__callId__))\n            };\n          });\n        }\n      });\n\n      var handleException = function handleException(e) {\n        if (e instanceof Error) {\n          var name = e.name,\n              message = e.message,\n              stack = e.stack;\n          var exception = {\n            name: name,\n            message: message,\n            stack: stack\n          };\n\n          _this4.update(Object.assign({}, info, {\n            status: CallStates.ERROR,\n            exception: exception\n          })); // Always track errors to their originating call.\n\n\n          _this4.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[e, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          }); // We need to throw to break out of the play function, but we don't want to trigger a redbox\n          // so we throw an ignoredException, which is caught and silently ignored by Storybook.\n\n\n          if (call.interceptable && e !== alreadyCompletedException) {\n            throw IGNORED_EXCEPTION;\n          } // Non-interceptable calls need their exceptions forwarded to the next interceptable call.\n          // In case no interceptable call picks it up, it'll get rethrown in the \"completed\" phase.\n\n\n          _this4.setState(call.storyId, {\n            forwardedException: e\n          });\n\n          return e;\n        }\n\n        throw e;\n      };\n\n      try {\n        // An earlier, non-interceptable call might have forwarded an exception.\n        if (forwardedException) {\n          this.setState(call.storyId, {\n            forwardedException: undefined\n          });\n          throw forwardedException;\n        }\n\n        if (renderPhase === 'played' && !call.retain) {\n          throw alreadyCompletedException;\n        }\n\n        var finalArgs = options.getArgs ? options.getArgs(call, this.getState(call.storyId)) : call.args;\n        var result = fn.apply(void 0, _toConsumableArray(finalArgs.map(function (arg) {\n          if (typeof arg !== 'function' || Object.keys(arg).length) return arg;\n          return function () {\n            var _this4$getState = _this4.getState(call.storyId),\n                cursor = _this4$getState.cursor,\n                parentId = _this4$getState.parentId;\n\n            _this4.setState(call.storyId, {\n              cursor: 0,\n              parentId: call.id\n            });\n\n            var restore = function restore() {\n              return _this4.setState(call.storyId, {\n                cursor: cursor,\n                parentId: parentId\n              });\n            };\n\n            var res = arg.apply(void 0, arguments);\n            if (res instanceof Promise) res.then(restore, restore);else restore();\n            return res;\n          };\n        }))); // Track the result so we can trace later uses of it back to the originating call.\n        // Primitive results (undefined, null, boolean, string, number, BigInt) are ignored.\n\n        if (result && ['object', 'function', 'symbol'].includes(_typeof(result))) {\n          this.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[result, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          });\n        }\n\n        this.update(Object.assign({}, info, {\n          status: result instanceof Promise ? CallStates.ACTIVE : CallStates.DONE\n        }));\n\n        if (result instanceof Promise) {\n          return result.then(function (value) {\n            _this4.update(Object.assign({}, info, {\n              status: CallStates.DONE\n            }));\n\n            return value;\n          }, handleException);\n        }\n\n        return result;\n      } catch (e) {\n        return handleException(e);\n      }\n    } // Sends the call info and log to the manager.\n    // Uses a 0ms debounce because this might get called many times in one tick.\n\n  }, {\n    key: \"update\",\n    value: function update(call) {\n      var _this5 = this;\n\n      clearTimeout(this.getState(call.storyId).syncTimeout);\n      this.channel.emit(EVENTS.CALL, call);\n      this.setState(call.storyId, function (_ref19) {\n        var calls = _ref19.calls;\n        // Omit earlier calls for the same ID, which may have been superceded by a later invocation.\n        // This typically happens when calls are part of a callback which runs multiple times.\n        var callsById = calls.concat(call).reduce(function (a, c) {\n          return Object.assign(a, _defineProperty({}, c.id, c));\n        }, {});\n        return {\n          // Calls are sorted to ensure parent calls always come before calls in their callback.\n          calls: Object.values(callsById).sort(function (a, b) {\n            return a.id.localeCompare(b.id, undefined, {\n              numeric: true\n            });\n          }),\n          syncTimeout: setTimeout(function () {\n            return _this5.sync(call.storyId);\n          }, 0)\n        };\n      });\n    }\n  }, {\n    key: \"sync\",\n    value: function sync(storyId) {\n      var _this$getState9 = this.getState(storyId),\n          isLocked = _this$getState9.isLocked,\n          isPlaying = _this$getState9.isPlaying;\n\n      var logItems = this.getLog(storyId);\n      var hasActive = logItems.some(function (item) {\n        return item.status === CallStates.ACTIVE;\n      });\n\n      if (debuggerDisabled || isLocked || hasActive || logItems.length === 0) {\n        this.channel.emit(EVENTS.SYNC, {\n          controlStates: controlsDisabled,\n          logItems: logItems\n        });\n        return;\n      }\n\n      var hasPrevious = logItems.some(function (item) {\n        return [CallStates.DONE, CallStates.ERROR].includes(item.status);\n      });\n      var controlStates = {\n        debugger: true,\n        start: hasPrevious,\n        back: hasPrevious,\n        goto: true,\n        next: isPlaying,\n        end: isPlaying\n      };\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlStates,\n        logItems: logItems\n      });\n    }\n  }]);\n\n  return Instrumenter;\n}();\n/**\n * Instruments an object or module by traversing its properties, patching any functions (methods)\n * to enable debugging. Patched functions will emit a `call` event when invoked.\n * When intercept = true, patched functions will return a Promise when the debugger stops before\n * this function. As such, \"interceptable\" functions will have to be `await`-ed.\n */\n\nexport function instrument(obj) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  try {\n    var _global$window$locati, _global$window$locati2, _global$window$locati3, _global$window$locati4;\n\n    var forceInstrument = false;\n    var skipInstrument = false;\n\n    if ((_global$window$locati = global.window.location) !== null && _global$window$locati !== void 0 && (_global$window$locati2 = _global$window$locati.search) !== null && _global$window$locati2 !== void 0 && _global$window$locati2.includes('instrument=true')) {\n      forceInstrument = true;\n    } else if ((_global$window$locati3 = global.window.location) !== null && _global$window$locati3 !== void 0 && (_global$window$locati4 = _global$window$locati3.search) !== null && _global$window$locati4 !== void 0 && _global$window$locati4.includes('instrument=false')) {\n      skipInstrument = true;\n    } // Don't do any instrumentation if not loaded in an iframe unless it's forced - instrumentation can also be skipped.\n\n\n    if (global.window.parent === global.window && !forceInstrument || skipInstrument) {\n      return obj;\n    } // Only create an instance if we don't have one (singleton) yet.\n\n\n    if (!global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__) {\n      global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__ = new Instrumenter();\n    }\n\n    var instrumenter = global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__;\n    return instrumenter.instrument(obj, options);\n  } catch (e) {\n    // Access to the parent window might fail due to CORS restrictions.\n    once.warn(e);\n    return obj;\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}