{"ast":null,"code":"import { __read, __spreadArray } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _a = options.connector,\n      connector = _a === void 0 ? function () {\n    return new Subject();\n  } : _a,\n      _b = options.resetOnError,\n      resetOnError = _b === void 0 ? true : _b,\n      _c = options.resetOnComplete,\n      resetOnComplete = _c === void 0 ? true : _c,\n      _d = options.resetOnRefCountZero,\n      resetOnRefCountZero = _d === void 0 ? true : _d;\n  return function (wrapperSource) {\n    var connection;\n    var resetConnection;\n    var subject;\n    var refCount = 0;\n    var hasCompleted = false;\n    var hasErrored = false;\n\n    var cancelReset = function () {\n      resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n      resetConnection = undefined;\n    };\n\n    var reset = function () {\n      cancelReset();\n      connection = subject = undefined;\n      hasCompleted = hasErrored = false;\n    };\n\n    var resetAndUnsubscribe = function () {\n      var conn = connection;\n      reset();\n      conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n    };\n\n    return operate(function (source, subscriber) {\n      refCount++;\n\n      if (!hasErrored && !hasCompleted) {\n        cancelReset();\n      }\n\n      var dest = subject = subject !== null && subject !== void 0 ? subject : connector();\n      subscriber.add(function () {\n        refCount--;\n\n        if (refCount === 0 && !hasErrored && !hasCompleted) {\n          resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n        }\n      });\n      dest.subscribe(subscriber);\n\n      if (!connection && refCount > 0) {\n        connection = new SafeSubscriber({\n          next: function (value) {\n            return dest.next(value);\n          },\n          error: function (err) {\n            hasErrored = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnError, err);\n            dest.error(err);\n          },\n          complete: function () {\n            hasCompleted = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnComplete);\n            dest.complete();\n          }\n        });\n        innerFrom(source).subscribe(connection);\n      }\n    })(wrapperSource);\n  };\n}\n\nfunction handleReset(reset, on) {\n  var args = [];\n\n  for (var _i = 2; _i < arguments.length; _i++) {\n    args[_i - 2] = arguments[_i];\n  }\n\n  if (on === true) {\n    reset();\n    return;\n  }\n\n  if (on === false) {\n    return;\n  }\n\n  var onSubscriber = new SafeSubscriber({\n    next: function () {\n      onSubscriber.unsubscribe();\n      reset();\n    }\n  });\n  return on.apply(void 0, __spreadArray([], __read(args))).subscribe(onSubscriber);\n} //# sourceMappingURL=share.js.map","map":{"version":3,"names":["__read","__spreadArray","innerFrom","Subject","SafeSubscriber","operate","share","options","_a","connector","_b","resetOnError","_c","resetOnComplete","_d","resetOnRefCountZero","wrapperSource","connection","resetConnection","subject","refCount","hasCompleted","hasErrored","cancelReset","unsubscribe","undefined","reset","resetAndUnsubscribe","conn","source","subscriber","dest","add","handleReset","subscribe","next","value","error","err","complete","on","args","_i","arguments","length","onSubscriber","apply"],"sources":["/Users/victorsan/Documents/htdocs/wabi-demo-monorepo/node_modules/rxjs/dist/esm5/internal/operators/share.js"],"sourcesContent":["import { __read, __spreadArray } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share(options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.connector, connector = _a === void 0 ? function () { return new Subject(); } : _a, _b = options.resetOnError, resetOnError = _b === void 0 ? true : _b, _c = options.resetOnComplete, resetOnComplete = _c === void 0 ? true : _c, _d = options.resetOnRefCountZero, resetOnRefCountZero = _d === void 0 ? true : _d;\n    return function (wrapperSource) {\n        var connection;\n        var resetConnection;\n        var subject;\n        var refCount = 0;\n        var hasCompleted = false;\n        var hasErrored = false;\n        var cancelReset = function () {\n            resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n            resetConnection = undefined;\n        };\n        var reset = function () {\n            cancelReset();\n            connection = subject = undefined;\n            hasCompleted = hasErrored = false;\n        };\n        var resetAndUnsubscribe = function () {\n            var conn = connection;\n            reset();\n            conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n        };\n        return operate(function (source, subscriber) {\n            refCount++;\n            if (!hasErrored && !hasCompleted) {\n                cancelReset();\n            }\n            var dest = (subject = subject !== null && subject !== void 0 ? subject : connector());\n            subscriber.add(function () {\n                refCount--;\n                if (refCount === 0 && !hasErrored && !hasCompleted) {\n                    resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n                }\n            });\n            dest.subscribe(subscriber);\n            if (!connection &&\n                refCount > 0) {\n                connection = new SafeSubscriber({\n                    next: function (value) { return dest.next(value); },\n                    error: function (err) {\n                        hasErrored = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnError, err);\n                        dest.error(err);\n                    },\n                    complete: function () {\n                        hasCompleted = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnComplete);\n                        dest.complete();\n                    },\n                });\n                innerFrom(source).subscribe(connection);\n            }\n        })(wrapperSource);\n    };\n}\nfunction handleReset(reset, on) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    if (on === true) {\n        reset();\n        return;\n    }\n    if (on === false) {\n        return;\n    }\n    var onSubscriber = new SafeSubscriber({\n        next: function () {\n            onSubscriber.unsubscribe();\n            reset();\n        },\n    });\n    return on.apply(void 0, __spreadArray([], __read(args))).subscribe(onSubscriber);\n}\n//# sourceMappingURL=share.js.map"],"mappings":"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"},"metadata":{},"sourceType":"module"}